unique_name: dim_time_dataset
object_type: dataset
label: dim_time_dataset
columns:
  - name: pk_date
    data_type: datetime
  - name: datekey
    data_type: int
  - name: date_name
    data_type: string
  - name: year
    data_type: string
  - name: year_name
    data_type: string
  - name: half_year
    data_type: date
  - name: half_year_name
    data_type: string
  - name: quarter
    data_type: date
  - name: quarter_name
    data_type: string
  - name: month
    data_type: date
  - name: month_name
    data_type: string
  - name: week
    data_type: date
  - name: week_name
    data_type: string
  - name: day_of_year
    data_type: int
  - name: day_of_year_name
    data_type: string
  - name: day_of_week
    data_type: int
  - name: day_of_week_name
    data_type: string
  - name: week_of_year
    data_type: int
  - name: week_of_year_name
    data_type: string
  - name: month_of_year
    data_type: int
  - name: month_of_year_name
    data_type: string
  - name: quarter_of_year
    data_type: int
  - name: quarter_of_year_name
    data_type: string
connection_id: con1
sql: |-
  CREATE TABLE 
      datecustom AS
  SELECT 
      date_day::TIMESTAMP                          AS pk_date,
      CAST(TO_CHAR(date_day, '%Y%m%d') AS DECIMAL) AS datekey,
      TO_CHAR(date_day, '%A, %B %d, %Y')           AS date_name,
      CAST(EXTRACT(YEAR FROM date_day) AS STRING)  AS YEAR,
      concat('Calendar ',TO_CHAR(date_day, '%Y'))  AS year_name,
      IFF(EXTRACT(QUARTER FROM date_day) < 3, DATE_TRUNC('year', date_day), DATEADD('quarter', 2, 
      DATE_TRUNC('year', date_day))) AS half_year,
      IFF(EXTRACT(QUARTER FROM date_day) < 3, concat('Semester 1, ',TO_CHAR(date_day, '%Y')), concat 
      ('Semester 2, ', TO_CHAR(date_day, '%Y')))                                    AS half_year_name,
      DATE_TRUNC('quarter', date_day)                                                      AS quarter,
      concat('Quarter ', EXTRACT(QUARTER FROM date_day), ', ', EXTRACT(YEAR FROM date_day)) AS 
                                       quarter_name,
      DATE_TRUNC('month', date_day)                                           AS MONTH,
      TO_CHAR(date_day, '%B %Y')                                              AS month_name,
      DATE_TRUNC('week', date_day)                                            AS week,
      concat('Week ', EXTRACT(WEEK FROM date_day), TO_CHAR(date_day, ', %Y')) AS week_name,
      EXTRACT(DAYOFYEAR FROM date_day)                                        AS day_of_year,
      concat('Day ', EXTRACT(DAYOFYEAR FROM date_day))                        AS day_of_year_name,
      EXTRACT(DAYOFWEEK FROM date_day)                                        AS day_of_week,
      DAYNAME(date_day)                                                       AS day_of_week_name,
      EXTRACT(WEEK FROM date_day)                                             AS week_of_year,
      concat('Week ', EXTRACT(WEEK FROM date_day))                            AS week_of_year_name,
      EXTRACT(MONTH FROM date_day)                                            AS month_of_year,
      MONTHNAME(date_day)                                                     AS month_of_year_name,
      EXTRACT(QUARTER FROM date_day)                                          AS quarter_of_year,
      concat('Quarter ', EXTRACT(QUARTER FROM date_day))                      AS quarter_of_year_name
  FROM 
      (   SELECT 
              DATEADD(DAY, ROW_NUMBER() OVER (ORDER BY 1) - 1, '1990-01-01') date_day
          FROM 
              TABLE(GENERATOR(ROWCOUNT => 3650)) );
