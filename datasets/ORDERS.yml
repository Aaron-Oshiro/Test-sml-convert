unique_name: ORDERS
object_type: dataset
label: ORDERS
columns:
  - name: O_ORDERKEY
    data_type: decimal
  - name: O_CUSTKEY
    data_type: decimal
  - name: O_ORDERSTATUS
    data_type: string
  - name: O_TOTALPRICE
    data_type: decimal
  - name: O_ORDERDATE
    data_type: date
  - name: O_ORDERPRIORITY
    data_type: string
  - name: O_CLERK
    data_type: string
  - name: O_SHIPPRIORITY
    data_type: decimal
  - name: O_COMMENT
    data_type: string
  - name: DIM_DAY
    data_type: date
    sql: DATE_TRUNC('DAY', O_ORDERDATE)
  - name: DIM_MONTH
    data_type: date
    sql: DATE_TRUNC('MONTH', O_ORDERDATE)
  - name: DIM_QUARTER
    data_type: date
    sql: DATE_TRUNC('QUARTER', O_ORDERDATE)
  - name: DIM_QUARTER_NUMBER
    data_type: decimal
    sql: EXTRACT('QUARTER', O_ORDERDATE)
  - name: DIM_YEAR_NUMBER
    data_type: decimal
    sql: EXTRACT(YEAR FROM O_ORDERDATE)
  - name: F_CUSTKEY_IF_MANY_QUARTERLY_ORDERS
    data_type: decimal
    sql: |-
      CASE
            WHEN COUNT(*) OVER(PARTITION BY O_CUSTKEY, DATE_TRUNC('QUARTER', O_ORDERDATE)) > 1
            THEN O_CUSTKEY
            END
  - name: F_ORDER_TOTAL
    data_type: decimal
    sql: LINEITEM.sales
connection_id: con_ATSCALE_SV_TEST_TPCH_SF1
table: TPCH_ORDERS
